<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Aplicação de Lançamentos</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            background-image: url('https://i.pinimg.com/736x/01/22/d9/0122d95177d733f1dabd36acca11fef5.jpg');
            background-size: cover;
            background-repeat: no-repeat;
            color: white;
        }

        .input-group-text {
            min-width: 70px;
            justify-content: center;
        }

        .input-group-prepend {
            margin-right: -1px;
        }

        .values-below {
            display: flex;
            justify-content: space-between;
            padding-top: 5px;
        }

        .chart-container {
            display: flex;
            justify-content: space-between;
        }

        .report-item {
            flex: 1;
            margin-right: 20px;
            text-align: center;
        }

        #successMessage, #errorMessage {
            display: none;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <div class="row">
            <div class="col-md-4">
                <h2>Inserir Dados</h2>
                <div class="form-group">
                    <label for="dataLancamento">Data:</label>
                    <input type="date" id="dataLancamento" class="form-control">
                </div>
                <h4>Faca Superior</h4>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">L.R</span>
                    </div>
                    <input type="number" id="facaSuperiorLR" class="form-control" placeholder="0">
                </div>
                <div class="values-below">
                    <span id="facaSuperiorLRValue">0</span>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">M</span>
                    </div>
                    <input type="number" id="facaSuperiorM" class="form-control" placeholder="0">
                </div>
                <div class="values-below">
                    <span id="facaSuperiorMValue">0</span>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">L.C</span>
                    </div>
                    <input type="number" id="facaSuperiorLC" class="form-control" placeholder="0">
                </div>
                <div class="values-below">
                    <span id="facaSuperiorLCValue">0</span>
                </div>
                <h4>Faca Inferior</h4>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">L.R</span>
                    </div>
                    <input type="number" id="facaInferiorLR" class="form-control" placeholder="0">
                </div>
                <div class="values-below">
                    <span id="facaInferiorLRValue">0</span>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">M</span>
                    </div>
                    <input type="number" id="facaInferiorM" class="form-control" placeholder="0">
                </div>
                <div class="values-below">
                    <span id="facaInferiorMValue">0</span>
                </div>
                <div class="input-group mb-3">
                    <div class="input-group-prepend">
                        <span class="input-group-text">L.C</span>
                    </div>
                    <input type="number" id="facaInferiorLC" class="form-control" placeholder="0">
                </div>
                <div class="values-below">
                    <span id="facaInferiorLCValue">0</span>
                </div>
                <button class="btn btn-primary btn-block" onclick="salvarDados()">Salvar</button>
                <button class="btn btn-danger btn-block" onclick="deletarDados()">Deletar</button>
                <div id="successMessage" class="alert alert-success">Dados salvos com sucesso!</div>
                <div id="errorMessage" class="alert alert-danger">Erro ao salvar dados.</div>
            </div>
            <div class="col-md-8">
                <h2>Lançamentos</h2>
                <select id="launchSelector" class="form-control mb-3" onchange="loadDataByLaunch(this.value)"></select>
                <div class="chart-container">
                    <div class="chart-item">
                        <canvas id="chartFacaSuperior"></canvas>
                    </div>
                    <div class="chart-item">
                        <canvas id="chartFacaInferior"></canvas>
                    </div>
                </div>
                <div id="reportContent" class="mt-3"></div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.7/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
    <script>
        // Firebase configuration and initialization
        const firebaseConfig = {
            apiKey: "AIzaSyDEsJtoWAUNgStvKg-0mE5CS8qlSLQt7bA",
            authDomain: "myapp2-a3c3f.firebaseapp.com",
            databaseURL: "https://myapp2-a3c3f-default-rtdb.firebaseio.com",
            projectId: "myapp2-a3c3f",
            storageBucket: "myapp2-a3c3f.appspot.com",
            messagingSenderId: "746305842581",
            appId: "1:746305842581:web:0059c0e45f82fd07a01a9c"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // Placeholder values
        const targetValues = {
            superior: { lr: 100, m: 100, lc: 100 },
            inferior: { lr: 100, m: 100, lc: 100 }
        };

        document.getElementById('facaSuperiorLR').addEventListener('input', (e) => updateValues('facaSuperiorLR', e.target.value));
        document.getElementById('facaSuperiorM').addEventListener('input', (e) => updateValues('facaSuperiorM', e.target.value));
        document.getElementById('facaSuperiorLC').addEventListener('input', (e) => updateValues('facaSuperiorLC', e.target.value));
        document.getElementById('facaInferiorLR').addEventListener('input', (e) => updateValues('facaInferiorLR', e.target.value));
        document.getElementById('facaInferiorM').addEventListener('input', (e) => updateValues('facaInferiorM', e.target.value));
        document.getElementById('facaInferiorLC').addEventListener('input', (e) => updateValues('facaInferiorLC', e.target.value));

        function updateValues(id, value) {
            document.getElementById(`${id}Value`).textContent = value || '0';
        }

        function salvarDados() {
            const dadosFacaSuperior = {
                lr: parseFloat(document.getElementById('facaSuperiorLR').value) || 0,
                m: parseFloat(document.getElementById('facaSuperiorM').value) || 0,
                lc: parseFloat(document.getElementById('facaSuperiorLC').value) || 0
            };

            const dadosFacaInferior = {
                lr: parseFloat(document.getElementById('facaInferiorLR').value) || 0,
                m: parseFloat(document.getElementById('facaInferiorM').value) || 0,
                lc: parseFloat(document.getElementById('facaInferiorLC').value) || 0
            };

            const dataLancamento = document.getElementById('dataLancamento').value;

            if (!dataLancamento) {
                alert('Por favor, insira a data do lançamento.');
                return;
            }

            const newLaunchKey = database.ref().child('launches').push().key;

            const updates = {};
            updates['/launches/' + newLaunchKey] = {
                dataLancamento,
                dadosFacaSuperior,
                dadosFacaInferior
            };

            database.ref().update(updates, function(error) {
                if (error) {
                    document.getElementById('errorMessage').style.display = 'block';
                } else {
                    document.getElementById('successMessage').style.display = 'block';
                    setTimeout(() => {
                        document.getElementById('successMessage').style.display = 'none';
                    }, 3000);
                }
            });
        }

        function deletarDados() {
            // Deletar lógica a ser adicionada
        }

        function loadDataByLaunch(launchKey) {
            if (!launchKey) return;

            database.ref('/launches/' + launchKey).once('value').then(function(snapshot) {
                const launchData = snapshot.val();

                document.getElementById('dataLancamento').value = launchData.dataLancamento;
                document.getElementById('facaSuperiorLR').value = launchData.dadosFacaSuperior.lr;
                document.getElementById('facaSuperiorM').value = launchData.dadosFacaSuperior.m;
                document.getElementById('facaSuperiorLC').value = launchData.dadosFacaSuperior.lc;
                document.getElementById('facaInferiorLR').value = launchData.dadosFacaInferior.lr;
                document.getElementById('facaInferiorM').value = launchData.dadosFacaInferior.m;
                document.getElementById('facaInferiorLC').value = launchData.dadosFacaInferior.lc;

                updateValues('facaSuperiorLR', launchData.dadosFacaSuperior.lr);
                updateValues('facaSuperiorM', launchData.dadosFacaSuperior.m);
                updateValues('facaSuperiorLC', launchData.dadosFacaSuperior.lc);
                updateValues('facaInferiorLR', launchData.dadosFacaInferior.lr);
                updateValues('facaInferiorM', launchData.dadosFacaInferior.m);
                updateValues('facaInferiorLC', launchData.dadosFacaInferior.lc);

                // Atualizar gráficos
            });
        }

        function carregarLançamentos() {
            database.ref('/launches/').once('value', function(snapshot) {
                const launchSelector = document.getElementById('launchSelector');
                launchSelector.innerHTML = '<option value="">Selecione um lançamento</option>';

                snapshot.forEach(function(childSnapshot) {
                    const key = childSnapshot.key;
                    const launch = childSnapshot.val();
                    const option = document.createElement('option');
                    option.value = key;
                    option.textContent = `Lançamento ${launch.dataLancamento}`;
                    launchSelector.appendChild(option);
                });
            });
        }

        carregarLançamentos();
    </script>
</body>
</html>
